var Doctyper={vars:{twitterAPI:"/api/twitter.json",githubAPI:"/api/github.json",eventActions:{"default":"did a thing",push:"pushed to",create:"created branch",watch:"started watching","public":"open sourced",issuecomment:"commented on an issue",pullrequest:{opened:"opened a pull request",closed:"closed a pull request"},gist:{create:"created gist"}},maxLength:4,slideInterval:5e3},enableWorkSwitcher:function(){var a=$("#work"),b=a.find("h2 a");b.bind("click",function(b){b.preventDefault(),a.toggleClass("all")})},enableCarousel:function(){var a=$("#work"),b=a.find(".carousel ol"),c=a.find(".carousel ul li"),d;if(!Modernizr.csstransforms3d&&!Modernizr.csstransitions)return;c.bind("click",$.proxy(function(a,e){e||window.clearInterval(this.vars._interval),d=$(a.currentTarget),b.removeAttr("class"),b.addClass("position-"+(c.index(d)+1)),d.siblings().removeClass("active"),d.addClass("active"),this.vars.activeItem=d},this)),c.first().addClass("active"),this.vars.activeItem=c.first(),this.vars.navItems=c,this.vars._interval=window.setInterval($.proxy(this.cycleCarousel,this),this.vars.slideInterval)},cycleCarousel:function(){var a=this.vars.activeItem.next();a=a[0]?a:this.vars.navItems.first(),this.vars.navItems.removeClass("active"),a.trigger("click",!0)},callTwitterAPI:function(){var a=$.getJSON(this.vars.twitterAPI);a.success($.proxy(this.getTwitterInfo,this))},getTwitterInfo:function(a){var b=this.checkTootValidity(a);this.renderToots(b)},checkTootValidity:function(a){var b=[],c,d,e;for(d=0,e=a.length;d<e;d++)c=a[d],!/^@/.test(c.text)&&b.length<this.vars.maxLength&&(c=this.formatTootData(c),b.push(c));return b},formatTootData:function(a){var b=this.parseSource(a.source);return $.extend(a,{name:a.user.name,screen_name:a.user.screen_name,created:this.prettyDate(a.created_at),source_text:b.text})},renderToots:function(a){var b,c,d,e,f=$("#twitter ul");for(b=0,c=a.length;b<c;b++)d=a[b],e=window.ich.toot(d),f.append(e)},prettyDate:function(a){var b=new Date((a||"").replace(/-/g,"/").replace(/[TZ]/g," ")),c=((new Date).getTime()-b.getTime())/1e3,d=Math.floor(c/86400);if(isNaN(d)||d<0||d>=31)return;return d===0&&(c<60&&"just now"||c<120&&"1 minute ago"||c<3600&&Math.floor(c/60)+" minutes ago"||c<7200&&"1 hour ago"||c<86400&&Math.floor(c/3600)+" hours ago")||d===1&&"Yesterday"||d<7&&d+" days ago"||d<31&&Math.ceil(d/7)+" weeks ago"},parseSource:function(a){var b=$("<div></div>").html(a).children();return{link:b.attr("href"),text:b.text()}},callGitHubAPI:function(){var a=$.getJSON(this.vars.githubAPI);a.success($.proxy(this.getGithubInfo,this))},getGithubInfo:function(a){var b=this.checkEventValidity(a);this.renderEvents(b)},checkEventValidity:function(a){var b=[],c,d,e;for(d=0,e=a.length;d<e;d++){c=a[d],typeof c==typeof {}&&"public"in c&&(c=this.formatEventData(c),b.push(c));if(b.length>=this.vars.maxLength)break}return b},sanitizeType:function(a){return a.replace("Event","").toLowerCase()},parseEventURL:function(a){return(a||"").replace(/http(s)?\:\/\/api\.github\.com(\/(repo|user)s)?/,"//github.com")},parseEventType:function(a,b){a=this.sanitizeType(a);var c=this.vars.eventActions;return c[a]=c[a]||c["default"],c[a][b]||c[a]},formatEventData:function(a){var b,c,d;a.payload.commits&&$.each(a.payload.commits,$.proxy(function(a,b){var c=b.message,d=120;c.length>d&&(c=c.substring(0,d-3).trim()+"&hellip;"),$.extend(b,{url:this.parseEventURL(b.url),sha:b.sha.substring(0,7),message:c})},this)),b={profile:this.parseEventURL(a.actor.url),screen_name:a.actor.login,action:this.parseEventType(a.type,a.payload.action),created:this.prettyDate(a.created_at),repo:$.extend(a.repo,{url:this.parseEventURL(a.repo.url)}),ref:a.payload.ref?a.payload.ref.replace("refs/heads/",""):null,commits:a.payload.commits,qualifier:!0};switch(a.type){case"GistEvent":c=a.payload.gist,$.extend(b,{qualifier:!1,repo:{name:c.id,url:c.html_url}}),b.commits=[{url:c.html_url,sha:c.id,message:c.description}];break;case"PublicEvent":case"WatchEvent":$.extend(b,{qualifier:!1});break;case"IssueCommentEvent":d=a.payload.issue,b.commits=[{url:d.html_url,sha:"Issue "+d.number,message:a.payload.comment.body}]}return a.type==="GistEvent"&&(c=a.payload.gist,$.extend(b.repo,{name:c.html_url.replace(/http(s)?\:\/\//,""),url:c.html_url}),b.commits=[{url:c.html_url,sha:c.id,message:c.description}]),b},renderEvents:function(a){var b,c,d,e,f=$("#github ul");for(b=0,c=a.length;b<c;b++)d=a[b],e=window.ich.event(d),f.append(e)},onLoad:function(){this.enableWorkSwitcher(),this.enableCarousel(),this.callTwitterAPI(),this.callGitHubAPI()},init:function(){$(document).ready($.proxy(this.onLoad,this))}}